(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{109:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(23),r=a.n(c),l=(a(79),a(6)),i=a.n(l),d=a(11),o=a(3),j=a(17),b=a.n(j),u=Object(n.createContext)(),h=a(0);var m=function(e){var t=Object(n.useState)([]),a=Object(o.a)(t,2),s=a[0],c=a[1],r=Object(n.useState)([]),l=Object(o.a)(r,2),j=l[0],m=l[1],O=Object(n.useState)([]),x=Object(o.a)(O,2),p=x[0],v=x[1],f=Object(n.useState)([]),g=Object(o.a)(f,2),N=g[0],y=g[1],S=Object(n.useState)([]),w=Object(o.a)(S,2),C=w[0],E=w[1],D=Object(n.useState)([]),A=Object(o.a)(D,2),I=A[0],L=A[1],P=function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/staff/fetchusers");case 3:return t=e.sent,c(t.data),e.abrupt("return",t.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("http://localhost:4000/api/leave/",t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(d.a)(i.a.mark((function e(t,a,n,s,c){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.put("http://localhost:4000/api/leave/".concat(t,"/").concat(a,"/").concat(n,"/").concat(s,"/").concat(c));case 3:return r=e.sent,e.abrupt("return",r.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a,n,s,c){return e.apply(this,arguments)}}(),q=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.delete("http://localhost:4000/api/staff/".concat(t));case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.delete("http://localhost:4000/api/leave/".concat(t));case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/staff/".concat(t));case 3:a=e.sent,m(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/".concat(t));case 3:a=e.sent,v(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/hod/".concat(t));case 3:a=e.sent,y(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/");case 3:t=e.sent,E(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("http://localhost:4000/api/auth/login",t,{headers:{"Content-Type":"application/json"}});case 3:return a=e.sent,localStorage.setItem("storedUser",JSON.stringify(a.data)),e.abrupt("return",a.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/principal/allLeaves");case 3:t=e.sent,L(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)(u.Provider,{value:{getusers:P,userArr:s,deleteUser:q,postLeaveDetails:k,recievedRequests:M,recievedLeaveArr:j,myRequestedLeaves:T,requestedLeavesArr:p,staffStatus:F,requestesForHod:R,requestesForHodArr:N,requestsForAdmin:J,requestsForAdminArr:C,login:_,deleteLeave:H,getAllLeaves:U,allLeavesArr:I,setuserArr:c},children:e.children})},O=a(8),x=a(2),p=a(122),v=a(117),f=a(64),g=a(65),N=a(118),y=a(119),S=a(66),w=a.n(S),C=a(9),E=a(10);var D=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(!1),r=Object(o.a)(c,2),l=r[0],j=r[1],m=Object(n.useState)(!0),S=Object(o.a)(m,2),D=S[0],A=S[1],I=Object(n.useState)({}),L=Object(o.a)(I,2),P=L[0],k=L[1],F=Object(n.useState)({}),q=Object(o.a)(F,2),H=q[0],M=q[1],T=Object(n.useState)([]),R=Object(o.a)(T,2),J=R[0],_=R[1],U=Object(n.useContext)(u),B=U.getusers,G=U.userArr,V=U.deleteUser,Y=Object(C.f)(),$=JSON.parse(localStorage.getItem("storedUser")),W=null===$||void 0===$?void 0:$.user;Object(n.useEffect)((function(){"Admin"===(null===W||void 0===W?void 0:W.role)&&null!==$||Y("/login")}),[a]);var z=function(e){var t={};return e.staffId||(t.staffId="Staff Id is required "),e.staffName||(t.staffName="Staff name  is required "),e.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(t.email="Enter a valid email address"):t.email="Email id  is required ",e.password||(t.password="Password  is required "),e.joiningDate||(t.joiningDate="Joining date  is required "),e.phnumber?/^[+]?[(]?[0-9]{3}[)]?[-\s.]?[0-9]{3}[-\s.]?[0-9]{4,6}$/im.test(e.phnumber)||(t.phnumber="Enter a valid phone number"):t.phnumber="Phone number  is required ",e.role||(t.role="Role is required "),e.type||(t.type="Type  is required "),"Principal"!==e.role&&(e.department||(t.department="department  is required ")),t};Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Admin"!==(null===W||void 0===W?void 0:W.role)){e.next=5;break}return e.next=3,B();case 3:(t=e.sent)?_(t):E.b.error("Internal Server Error");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[l]);var K=function(){var e=Object(d.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),M(z(P)),P.staffId&&P.staffName&&P.email&&P.joiningDate&&P.password&&P.phnumber&&"Principal"!==P.role?P.type&&P.department:P.type){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,b.a.post("http://localhost:4000/api/auth/register",P);case 7:!1===(n=e.sent).data.success?E.b.error(n.data.msg):n.data.success&&E.b.success("user successfully created"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:s(!a);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t._id);case 2:(a=e.sent)?E.b.success(a):E.b.error("internal server error"),j(!l);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(e){"Staff"===P.role||"Hod"===P.role?A(!1):A(!0),k(Object(x.a)(Object(x.a)({},P),{},Object(O.a)({},e.target.name,e.target.value)))};return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"container my-5",children:[Object(h.jsx)("h1",{children:"Create a new staff member"}),Object(h.jsx)("hr",{}),Object(h.jsxs)(p.a,{onSubmit:K,children:[Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Staff ID"}),Object(h.jsxs)(f.a,{sm:"10",children:[Object(h.jsx)(p.a.Control,{onChange:X,name:"staffId",type:"text",placeholder:"Staff Id"}),Object(h.jsx)("p",{className:"text-danger",children:H.staffId})]})]}),Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Staff Name"}),Object(h.jsxs)(f.a,{sm:"10",children:[Object(h.jsx)(p.a.Control,{onChange:X,name:"staffName",type:"text",placeholder:"Staff Name"}),Object(h.jsx)("p",{className:"text-danger",children:H.staffName})]})]}),Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Email"}),Object(h.jsxs)(f.a,{sm:"10",children:[Object(h.jsx)(p.a.Control,{onChange:X,type:"email",name:"email",placeholder:"Email"}),Object(h.jsx)("p",{className:"text-danger",children:H.email})]})]}),Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Password"}),Object(h.jsxs)(f.a,{sm:"10",children:[Object(h.jsx)(p.a.Control,{onChange:X,type:"Password",name:"password",placeholder:"Password"}),Object(h.jsx)("p",{className:"text-danger",children:H.password})]})]}),Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Joining Date"}),Object(h.jsxs)(f.a,{sm:"10",children:[Object(h.jsx)(p.a.Control,{onChange:X,type:"date",name:"joiningDate"})," ",Object(h.jsx)("p",{className:"text-danger",children:H.joiningDate})]})]}),Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Phone Number"}),Object(h.jsxs)(f.a,{sm:"10",children:[Object(h.jsx)(p.a.Control,{onChange:X,type:"tel",name:"phnumber",placeholder:"Phone Number"}),Object(h.jsx)("p",{className:"text-danger",children:H.phnumber})]})]}),Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Role"}),Object(h.jsx)(f.a,{sm:"10",children:Object(h.jsxs)(g.a,{controlId:"floatingSelect",label:"Select a role",children:[Object(h.jsxs)(p.a.Select,{"aria-label":"Floating label select example",name:"role",onChange:X,children:[Object(h.jsx)("option",{}),Object(h.jsx)("option",{value:"Hod",children:"Hod"}),Object(h.jsx)("option",{value:"Staff",children:"Staff"}),Object(h.jsx)("option",{value:"Principal",children:"Principal"})]})," ",Object(h.jsx)("p",{className:"text-danger",children:H.role})]})})]}),Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Type"}),Object(h.jsx)(f.a,{sm:"10",children:Object(h.jsxs)(g.a,{controlId:"floatingSelect",label:"Select type of Staff",children:[Object(h.jsxs)(p.a.Select,{"aria-label":"Floating label select example",name:"type",onChange:X,children:[Object(h.jsx)("option",{children:" "}),Object(h.jsx)("option",{value:"Regular",children:"Regular"}),Object(h.jsx)("option",{value:"Probation",children:"Probation"})]})," ",Object(h.jsx)("p",{className:"text-danger",children:H.type})]})})]}),Object(h.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextPassword",children:[Object(h.jsx)(p.a.Label,{column:!0,sm:"2",children:"Department"}),Object(h.jsx)(f.a,{sm:"10",children:Object(h.jsxs)(g.a,{controlId:"floatingSelect",label:"Select a department",children:[Object(h.jsxs)(p.a.Select,{"aria-label":"Floating label select example",name:"department",disabled:D,onChange:X,children:[Object(h.jsx)("option",{}),Object(h.jsx)("option",{value:"CSE",children:"CSE"}),Object(h.jsx)("option",{value:"ECE",children:"ECE"}),Object(h.jsx)("option",{value:"EEE",children:"EEE"}),Object(h.jsx)("option",{value:"CIV",children:"CIV"}),Object(h.jsx)("option",{value:"PHY",children:"PHY"}),Object(h.jsx)("option",{value:"CHEM",children:"CHEM"}),Object(h.jsx)("option",{value:"MATH",children:"MATH"}),Object(h.jsx)("option",{value:"OFFICE",children:"OFFICE"}),Object(h.jsx)("option",{value:"MBA",children:"MBA"}),Object(h.jsx)("option",{value:"MCA",children:"MCA"})]})," ",Object(h.jsx)("p",{className:"text-danger",children:H.department})]})})]}),Object(h.jsx)(p.a.Group,{children:Object(h.jsx)(N.a,{variant:"primary",type:"submit",children:"Submit"})}),Object(h.jsx)("hr",{})]}),Object(h.jsxs)("div",{className:"dropdown",children:[Object(h.jsx)("label",{children:"Filter staff by department"}),Object(h.jsxs)("select",{onChange:function(e){if("ALL"===e.target.value)_(G);else{var t=null===G||void 0===G?void 0:G.filter((function(t){return t.department===e.target.value}));_(t),s(!a)}},label:"Select Department to view staff",children:[Object(h.jsx)("option",{className:"dropdown-item",value:"ALL",children:"ALL"}),Object(h.jsx)("option",{className:"dropdown-item",value:"CSE",children:"CSE"}),Object(h.jsx)("option",{className:"dropdown-item",value:"ECE",children:"ECE"}),Object(h.jsx)("option",{className:"dropdown-item",value:"EEE",children:"EEE"}),Object(h.jsx)("option",{className:"dropdown-item",value:"CIV",children:"CIV"}),Object(h.jsx)("option",{className:"dropdown-item",value:"PHY",children:"PHY"}),Object(h.jsx)("option",{className:"dropdown-item",value:"CHEM",children:"CHEM"}),Object(h.jsx)("option",{className:"dropdown-item",value:"MATH",children:"MATH"}),Object(h.jsx)("option",{className:"dropdown-item",value:"OFFICE",children:"OFFICE"}),Object(h.jsx)("option",{className:"dropdown-item",value:"MBA",children:"MBA"}),Object(h.jsx)("option",{className:"dropdown-item",value:"MCA",children:"MCA"})]})]}),Object(h.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Staff ID"}),Object(h.jsx)("th",{children:"Full Name"}),Object(h.jsx)("th",{children:"Email "}),Object(h.jsx)("th",{children:"Phone Number"}),Object(h.jsx)("th",{children:"Role"}),Object(h.jsx)("th",{children:"Type"}),Object(h.jsx)("th",{children:"Leaves remaining"}),Object(h.jsx)("th",{children:"Department"})]})}),Object(h.jsx)("tbody",{children:null===J||void 0===J?void 0:J.map((function(e){return Object(h.jsx)("tr",{children:"Admin"!==e.role&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("td",{children:e.staffId}),Object(h.jsx)("td",{children:e.staffName}),Object(h.jsx)("td",{children:e.email}),Object(h.jsx)("td",{children:e.phnumber}),Object(h.jsx)("td",{children:e.role}),Object(h.jsx)("td",{children:e.type}),Object(h.jsx)("td",{children:"Regular"===e.type?Object(h.jsx)("span",{children:e.earnedLeaves+e.regularStaffLeaves}):Object(h.jsx)("span",{children:e.probationStaffLeaves})}),Object(h.jsxs)("td",{style:{display:"flex",justifyContent:"space-between",cursor:"pointer"},children:[Object(h.jsx)("span",{children:e.department}),Object(h.jsx)("span",{onClick:function(){return Q(e)},children:Object(h.jsx)(w.a,{})})]})]})},e.staffId)}))})]})]})})};a(53);var A=function(){var e=Object(n.useContext)(u),t=Object(C.f)(),a=e.login,s=Object(n.useState)({}),c=Object(o.a)(s,2),r=c[0],l=c[1],j=Object(n.useState)({}),b=Object(o.a)(j,2),m=b[0],p=b[1];Object(n.useEffect)((function(){localStorage.removeItem("storedUser");var e=sessionStorage.getItem("reloadCount");e<1?(sessionStorage.setItem("reloadCount",String(e+1)),window.location.reload()):sessionStorage.removeItem("reloadCount")}),[]);var v=function(e){l(Object(x.a)(Object(x.a)({},r),{},Object(O.a)({},e.target.name,e.target.value)))},f=function(){var e=Object(d.a)(i.a.mark((function e(n){var s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),p(g(r)),!r.email||!r.password){e.next=7;break}return e.next=5,a(r);case 5:e.sent?(null===(s=JSON.parse(localStorage.getItem("storedUser")))||void 0===s?void 0:s.success)?"Staff"===(null===(c=null===s||void 0===s?void 0:s.user)||void 0===c?void 0:c.role)||"Hod"===(null===c||void 0===c?void 0:c.role)?t("/"):"Principal"===(null===c||void 0===c?void 0:c.role)?t("/principal"):"Admin"===(null===c||void 0===c?void 0:c.role)&&t("/admin"):r.email&&r.password&&E.b.error("Wrong credentials"):E.b.error("internal server error");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e){var t={};return e.email||(t.email="Email is required"),e.password||(t.password="Password is required"),t};return Object(h.jsx)("div",{className:"vertical-center",children:Object(h.jsx)("div",{className:" container border border-dark rounded",style:{padding:"1rem",width:"30%"},children:Object(h.jsxs)("form",{className:"requires-validation",onSubmit:f,children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsxs)("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:["Email address ",Object(h.jsx)("span",{className:"text-danger",children:" *"})]}),Object(h.jsx)("input",{type:"email",name:"email",onChange:v,className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp"}),Object(h.jsx)("p",{className:"text-danger",children:m.email})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsxs)("label",{htmlFor:"exampleInputPassword1",className:"form-label",children:["Password ",Object(h.jsx)("span",{className:"text-danger",children:" *"})]}),Object(h.jsx)("input",{type:"password",name:"password",onChange:v,className:"form-control",id:"exampleInputPassword1"}),Object(h.jsx)("p",{className:"text-danger",children:m.password})]}),Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Login"})]})})})};a(35);var I=function(){var e=Object(C.f)(),t=Object(n.useContext)(u),a=Object(n.useState)(!1),s=Object(o.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)([]),j=Object(o.a)(l,2),b=j[0],m=j[1],O=t.userArr,x=t.getusers,p=t.getAllLeaves,v=t.allLeavesArr;Object(n.useEffect)((function(){"Principal"!==(null===g||void 0===g?void 0:g.role)&&e("/login")}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Principal"!==(null===g||void 0===g?void 0:g.role)){e.next=5;break}return e.next=3,x();case 3:(t=e.sent)?m(t):E.b.error("Internal Server Error");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),p()}),[]);var f=JSON.parse(localStorage.getItem("storedUser")),g=null===f||void 0===f?void 0:f.user,N=new Date,S=[];return null===v||void 0===v||v.forEach((function(e){var t=new Date(e.dateStart),a=new Date(e.dateEnd);N.getDate()<=a.getDate()&&N.getDate()>=t.getDate()&&S.push(e)})),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"container center",children:[Object(h.jsxs)("div",{className:"card my-4",style:{width:"20rem",margin:"auto"},children:[Object(h.jsx)("div",{className:"card-header",children:(new Date).toDateString()}),Object(h.jsx)("div",{className:"card card-body",children:"todo"})]}),Object(h.jsx)("h1",{className:"my-4 text-center",children:"Jain College of Engineering Staff Details"}),Object(h.jsxs)("div",{className:"dropdown",children:[Object(h.jsx)("label",{children:"Filter staff by department"}),Object(h.jsxs)("select",{className:"btn btn-secondary dropdown-toggle",onChange:function(e){if("ALL"===e.target.value)m(O);else{var t=null===O||void 0===O?void 0:O.filter((function(t){return t.department===e.target.value}));m(t),r(!c)}},label:"Select Department to view staff",children:[Object(h.jsx)("option",{className:"dropdown-item",value:"ALL",children:"ALL"}),Object(h.jsx)("option",{className:"dropdown-item",value:"CSE",children:"CSE"}),Object(h.jsx)("option",{className:"dropdown-item",value:"ECE",children:"ECE"}),Object(h.jsx)("option",{className:"dropdown-item",value:"EEE",children:"EEE"}),Object(h.jsx)("option",{className:"dropdown-item",value:"CIV",children:"CIV"}),Object(h.jsx)("option",{className:"dropdown-item",value:"PHY",children:"PHY"}),Object(h.jsx)("option",{className:"dropdown-item",value:"CHEM",children:"CHEM"}),Object(h.jsx)("option",{className:"dropdown-item",value:"MATH",children:"MATH"}),Object(h.jsx)("option",{className:"dropdown-item",value:"OFFICE",children:"OFFICE"}),Object(h.jsx)("option",{className:"dropdown-item",value:"MBA",children:"MBA"}),Object(h.jsx)("option",{className:"dropdown-item",value:"MCA",children:"MCA"})]})]}),Object(h.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Staff ID"}),Object(h.jsx)("th",{children:"Full Name"}),Object(h.jsx)("th",{children:"Email "}),Object(h.jsx)("th",{children:"Phone Number"}),Object(h.jsx)("th",{children:"Role"}),Object(h.jsx)("th",{children:"Type"}),Object(h.jsx)("th",{children:"Leaves remaining"}),Object(h.jsx)("th",{children:"Department"})]})}),Object(h.jsx)("tbody",{children:b.map((function(e){return Object(h.jsx)("tr",{children:"Principal"!==e.role&&"Admin"!==e.role&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("td",{children:e.staffId}),Object(h.jsx)("td",{children:e.staffName}),Object(h.jsx)("td",{children:e.email}),Object(h.jsx)("td",{children:e.phnumber}),Object(h.jsx)("td",{children:e.role}),Object(h.jsx)("td",{children:e.type}),Object(h.jsx)("td",{children:"Regular"===e.type?Object(h.jsx)("span",{children:e.earnedLeaves+e.regularStaffLeaves}):Object(h.jsx)("span",{children:e.probationStaffLeaves})}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{children:e.department})})]})},e.staffId)}))})]})]})})},L=a(13),P=a(68),k=a.n(P),F=a(69),q=a.n(F),H=a(70),M=a.n(H);var T=function(){var e=JSON.parse(localStorage.getItem("storedUser")),t=null===e||void 0===e?void 0:e.user,a=Object(n.useState)(!1),s=Object(o.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)({}),j=Object(o.a)(l,2),b=j[0],m=j[1],O=Object(n.useState)([]),x=Object(o.a)(O,2),p=x[0],v=x[1],f=Object(n.useState)({}),g=Object(o.a)(f,2),N=g[0],S=g[1],w=Object(n.useContext)(u),D=Object(C.f)(),A=w.recievedLeaveArr,I=w.recievedRequests,P=w.requestedLeavesArr,F=w.myRequestedLeaves,H=w.staffStatus,T=w.requestesForHod,R=w.requestesForHodArr;Object(n.useEffect)((function(){"Admin"!==(null===t||void 0===t?void 0:t.role)&&"Principal"!==(null===t||void 0===t?void 0:t.role)||D("/login")}),[]),Object(n.useEffect)((function(){"Staff"!==(null===t||void 0===t?void 0:t.role)&&"Hod"!==(null===t||void 0===t?void 0:t.role)||F(null===t||void 0===t?void 0:t._id),"Staff"===(null===t||void 0===t?void 0:t.role)?I(null===t||void 0===t?void 0:t.staffName):"Hod"===(null===t||void 0===t?void 0:t.role)&&T(null===t||void 0===t?void 0:t.department)}),[c]);var J=0,_=function(e){m(e)};return Object(h.jsxs)("div",{className:"leaveReqDiv",children:[Object(h.jsx)("div",{className:"myRequests",children:Object(h.jsxs)("div",{className:"tableRequests",children:[Object(h.jsx)("h1",{children:"My leave requests"}),Object(h.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{className:"theads",children:[Object(h.jsx)("th",{children:"S.No"}),Object(h.jsx)("th",{children:"Subject"}),Object(h.jsx)("th",{children:"From"}),Object(h.jsx)("th",{children:"To"}),Object(h.jsx)("th",{children:"Staff-status"}),"Staff"===(null===t||void 0===t?void 0:t.role)?Object(h.jsx)("th",{children:"Hod-status"}):Object(h.jsx)("th",{children:"Admin-status"}),Object(h.jsx)("th",{children:"View Leave"})]})}),Object(h.jsx)("tbody",{children:Object(L.a)(P).reverse().map((function(e){return Object(h.jsxs)("tr",{className:"theads",children:[Object(h.jsx)("td",{children:J+=1}),Object(h.jsx)("td",{children:e.subject}),Object(h.jsx)("td",{children:new Date(e.dateStart).toDateString()}),Object(h.jsx)("td",{children:new Date(e.dateEnd).toDateString()}),Object(h.jsxs)("td",{children:[1!==e.byStaff&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#byStaffApproval",onClick:function(){return function(e){v(e.subStaffArr)}(e)},children:"view"}),Object(h.jsx)("div",{className:"modal fade",id:"byStaffApproval",tabIndex:"-1","aria-labelledby":"byStaffApprovalLabel","aria-hidden":"true",children:Object(h.jsx)("div",{className:"modal-dialog",children:Object(h.jsxs)("div",{className:"modal-content",children:[Object(h.jsxs)("div",{className:"modal-header",children:[Object(h.jsx)("h5",{className:"modal-title",id:"byStaffApprovalLabel",children:"Your substitute staff requests"}),Object(h.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(h.jsx)("div",{className:"modal-body",children:null===p||void 0===p?void 0:p.map((function(e){return Object(h.jsxs)("div",{style:{display:"flex"},children:[Object(h.jsxs)("h5",{children:["Name:",Object(h.jsx)("span",{children:null===e||void 0===e?void 0:e.name})]}),Object(h.jsxs)("h5",{className:"mx-2",children:["Status:",1===(null===e||void 0===e?void 0:e.status)&&Object(h.jsx)("span",{className:"text-success fw-bold",children:Object(h.jsx)(k.a,{})})||0===(null===e||void 0===e?void 0:e.status)&&Object(h.jsx)("span",{className:"text-warning fw-bold",children:Object(h.jsx)(q.a,{})})||2===(null===e||void 0===e?void 0:e.status)&&Object(h.jsx)("span",{className:"text-danger fw-bold",children:Object(h.jsx)(M.a,{})})]})]},e.name)}))}),Object(h.jsx)("div",{className:"modal-footer",children:Object(h.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})})]}),1===e.byStaff&&Object(h.jsx)("span",{className:"text-success fw-bold",children:"Approved"})]}),Object(h.jsxs)("td",{children:["Staff"===t.role?0===e.byHod&&Object(h.jsx)("span",{className:"text-warning fw-bold",children:"Pending..."}):0===e.byAdmin&&Object(h.jsx)("span",{className:"text-warning fw-bold",children:"Pending..."}),"Staff"===t.role?1===e.byHod&&Object(h.jsx)("span",{className:"text-success fw-bold",children:"Approved"}):1===e.byAdmin&&Object(h.jsx)("span",{className:"text-success fw-bold",children:"Approved"}),"Hod"!==t.role?2===e.byHod&&Object(h.jsx)("span",{className:"text-danger fw-bold",children:"Declined"}):2===e.byAdmin&&Object(h.jsx)("span",{className:"text-danger fw-bold",children:"Declined"})]}),Object(h.jsx)("td",{children:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#viewInDetail",onClick:function(){return function(e){S(e)}(e)},children:"view"}),Object(h.jsx)("div",{className:"modal fade",id:"viewInDetail",tabIndex:"-1","aria-labelledby":"viewInDetailLabel","aria-hidden":"true",children:Object(h.jsx)("div",{className:"modal-dialog",children:Object(h.jsxs)("div",{className:"modal-content",children:[Object(h.jsxs)("div",{className:"modal-header",children:[Object(h.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Leave request details"}),Object(h.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(h.jsxs)("div",{className:"modal-body",style:{textAlign:"left"},children:[Object(h.jsxs)("h5",{children:["Subject:",Object(h.jsx)("span",{children:null===N||void 0===N?void 0:N.subject})]}),Object(h.jsxs)("h5",{children:["Description:",Object(h.jsx)("span",{children:null===N||void 0===N?void 0:N.body})]}),Object(h.jsxs)("h5",{children:["Type:",Object(h.jsx)("span",{children:null===N||void 0===N?void 0:N.type})]}),Object(h.jsxs)("h5",{children:["From:",Object(h.jsx)("span",{children:new Date(null===N||void 0===N?void 0:N.dateStart).toDateString()})]}),Object(h.jsxs)("h5",{children:["To:",Object(h.jsx)("span",{children:new Date(null===N||void 0===N?void 0:N.dateEnd).toDateString()})]}),Object(h.jsxs)("h5",{children:["No. of days:",Object(h.jsx)("span",{children:null===N||void 0===N?void 0:N.noOfDays})]})]}),Object(h.jsx)("div",{className:"modal-footer",children:Object(h.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})})]})})]},e._id)}))})]})]})}),Object(h.jsxs)("div",{className:"recievedRequests",children:[Object(h.jsx)("h1",{children:"Substitution requests"}),Object(h.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Full Name"}),Object(h.jsx)("th",{children:"Subject"}),Object(h.jsx)("th",{children:"Start date"}),Object(h.jsx)("th",{children:"End date"}),Object(h.jsx)("th",{children:"Accept/Decline"})]})}),"Staff"===(null===t||void 0===t?void 0:t.role)?Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("tbody",{children:Object(L.a)(A).reverse().map((function(e){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{className:"center",children:e.name}),Object(h.jsx)("td",{className:"center",children:e.subject}),Object(h.jsx)("td",{className:"center",children:new Date(e.dateStart).toDateString()}),Object(h.jsx)("td",{className:"center",children:new Date(e.dateEnd).toDateString()}),Object(h.jsxs)("td",{style:{display:"flex",justifyContent:"space-around",cursor:"pointer"},children:[e.subStaffArr.some((function(e){return e.name===t.staffName&&0===e.status}))?Object(h.jsx)("button",{type:"button",className:"btn btn-primary ","data-bs-toggle":"modal","data-bs-target":"#bbb",onClick:function(){return _(e)},children:"View"}):Object(h.jsx)("span",{children:e.subStaffArr.some((function(e){return e.name===t.staffName&&1===e.status}))?Object(h.jsx)("span",{className:"text-success",children:"Accepted"}):Object(h.jsx)("span",{className:"text-danger",children:"Declined"})}),Object(h.jsx)("div",{className:"modal fade",id:"bbb",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(h.jsx)("div",{className:"modal-dialog",children:Object(h.jsxs)("div",{className:"modal-content",children:[Object(h.jsxs)("div",{className:"modal-header",children:[Object(h.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Leave request details"}),Object(h.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(h.jsxs)("div",{className:"modal-body ",children:[Object(h.jsxs)("h5",{children:["Name:",Object(h.jsx)("span",{children:null===b||void 0===b?void 0:b.name})]}),Object(h.jsxs)("h5",{children:["Subject:",Object(h.jsx)("span",{children:null===b||void 0===b?void 0:b.subject})]}),Object(h.jsxs)("h5",{children:["Description:",Object(h.jsx)("span",{children:null===b||void 0===b?void 0:b.body})]}),Object(h.jsxs)("h5",{children:["From:",Object(h.jsx)("span",{children:new Date(null===b||void 0===b?void 0:b.dateStart).toDateString()})]}),Object(h.jsxs)("h5",{children:["To:",Object(h.jsx)("span",{children:new Date(null===b||void 0===b?void 0:b.dateEnd).toDateString()})]})]}),Object(h.jsxs)("div",{className:"modal-footer",children:[Object(h.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(null===b||void 0===b?void 0:b._id,1,null===t||void 0===t?void 0:t.role,null===b||void 0===b?void 0:b.noOfDays,null===t||void 0===t?void 0:t.staffName);case 2:e.sent?(r(!c),E.b.info("Accepted")):E.b.danger("Internal server error");case 4:case"end":return e.stop()}}),e)}))),children:"Accept"}),Object(h.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-dismiss":"modal",onClick:Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(null===b||void 0===b?void 0:b._id,2,null===t||void 0===t?void 0:t.role,null===b||void 0===b?void 0:b.noOfDays,null===t||void 0===t?void 0:t.staffName);case 2:e.sent?(r(!c),E.b.info("Declined")):E.b.danger("Internal server error");case 4:case"end":return e.stop()}}),e)}))),children:"Decline"})]})]})})})]})]},e._id)}))})}):Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("tbody",{children:Object(L.a)(R).reverse().map((function(e){return Object(h.jsx)("tr",{children:e.userId!==t._id&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("td",{className:"center",children:e.name}),Object(h.jsx)("td",{className:"center",children:e.subject}),Object(h.jsx)("td",{className:"center",children:new Date(e.dateStart).toDateString()}),Object(h.jsx)("td",{className:"center",children:new Date(e.dateEnd).toDateString()}),Object(h.jsxs)("td",{style:{display:"flex",justifyContent:"space-around",cursor:"pointer"},children:[0===e.byHod?Object(h.jsx)("button",{type:"button",className:"btn btn-primary ","data-bs-toggle":"modal","data-bs-target":"#aaa",onClick:function(){return _(e)},children:"View"}):Object(h.jsx)("span",{children:1===e.byHod?Object(h.jsx)("span",{className:"text-success",children:"Accepted"}):Object(h.jsx)("span",{className:"text-danger",children:"Declined"})}),Object(h.jsx)("div",{className:"modal fade",id:"aaa",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(h.jsx)("div",{className:"modal-dialog",children:Object(h.jsxs)("div",{className:"modal-content",children:[Object(h.jsxs)("div",{className:"modal-header",children:[Object(h.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Leave request details"}),Object(h.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(h.jsxs)("div",{className:"modal-body",children:[Object(h.jsxs)("h5",{children:["Name:",Object(h.jsx)("span",{children:null===b||void 0===b?void 0:b.name})]}),Object(h.jsxs)("h5",{children:["Subject:",Object(h.jsx)("span",{children:null===b||void 0===b?void 0:b.subject})]}),Object(h.jsxs)("h5",{children:["Description:",Object(h.jsx)("span",{children:null===b||void 0===b?void 0:b.body})]}),Object(h.jsxs)("h5",{children:["From:",Object(h.jsx)("span",{children:new Date(null===b||void 0===b?void 0:b.dateStart).toDateString()})]}),Object(h.jsxs)("h5",{children:["To:",Object(h.jsx)("span",{children:new Date(null===b||void 0===b?void 0:b.dateEnd).toDateString()})]})]}),Object(h.jsxs)("div",{className:"modal-footer",children:[Object(h.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:function(){H(b._id,1,null===t||void 0===t?void 0:t.role,null===b||void 0===b?void 0:b.noOfDays,null===t||void 0===t?void 0:t.staffName),r(!c),E.b.info("Accepted")},children:"Accept"}),Object(h.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-dismiss":"modal",onClick:function(){H(b._id,2,null===t||void 0===t?void 0:t.role,null===b||void 0===b?void 0:b.noOfDays,null===t||void 0===t?void 0:t.staffName),r(!c),E.b.info("Declined")},children:"Decline"})]})]})})})]})]})},e._id)}))})})]})]})]})};var R=function(){var e=Object(C.f)();return Object(n.useEffect)((function(){localStorage.getItem("storedUser")||e("/login")}),[]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(T,{})})},J=a(15);var _=function(){var e,t=Object(C.f)(),a=Object(n.useState)({}),s=Object(o.a)(a,2),c=s[0],r=s[1],l=Object(n.useContext)(u),j=Object(n.useState)(!1),b=Object(o.a)(j,2),m=b[0],O=b[1],x=l.requestsForAdmin,p=l.requestsForAdminArr,v=l.staffStatus,f=JSON.parse(localStorage.getItem("storedUser")),g=null===f||void 0===f?void 0:f.user;return Object(n.useEffect)((function(){"Admin"!==(null===g||void 0===g?void 0:g.role)&&t("/login")}),[]),Object(n.useEffect)((function(){"Admin"===g.role&&x()}),[m]),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"container my-5",children:[Object(h.jsx)("h1",{className:"text-center mb-3",children:"Incoming leave applications"}),Object(h.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{className:"theads",children:[Object(h.jsx)("th",{children:"Full Name"}),Object(h.jsx)("th",{children:"Subject"}),Object(h.jsx)("th",{children:"Start date"}),Object(h.jsx)("th",{children:"End date"}),Object(h.jsx)("th",{children:"Accept/Decline"})]})}),Object(h.jsx)("tbody",{children:null===(e=Object(L.a)(p).reverse())||void 0===e?void 0:e.map((function(e){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{className:"center",children:e.name}),Object(h.jsx)("td",{className:"center",children:e.subject}),Object(h.jsx)("td",{className:"center",children:new Date(e.dateStart).toDateString()}),Object(h.jsx)("td",{className:"center",children:new Date(e.dateEnd).toDateString()}),Object(h.jsxs)("td",{style:{display:"flex",justifyContent:"space-around",cursor:"pointer"},children:[0===e.byAdmin?Object(h.jsx)("button",{type:"button",className:"btn btn-primary ","data-bs-toggle":"modal","data-bs-target":"#aaa",onClick:function(){r(e)},children:"View"}):Object(h.jsx)("span",{children:1===e.byAdmin?Object(h.jsx)("span",{className:"text-success",children:"Accepted"}):Object(h.jsx)("span",{className:"text-danger",children:"Declined"})}),Object(h.jsx)("div",{className:"modal fade",id:"aaa",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(h.jsx)("div",{className:"modal-dialog",children:Object(h.jsxs)("div",{className:"modal-content",children:[Object(h.jsxs)("div",{className:"modal-header",children:[Object(h.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Leave request details"}),Object(h.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(h.jsxs)("div",{className:"modal-body",children:[Object(h.jsxs)("h5",{children:["Name:",Object(h.jsx)("span",{children:null===c||void 0===c?void 0:c.name})]}),Object(h.jsxs)("h5",{children:["Subject:",Object(h.jsx)("span",{children:null===c||void 0===c?void 0:c.subject})]}),Object(h.jsxs)("h5",{children:["Description:",Object(h.jsx)("span",{children:null===c||void 0===c?void 0:c.body})]}),Object(h.jsxs)("h5",{children:["Type:",Object(h.jsx)("span",{children:null===c||void 0===c?void 0:c.type})]}),Object(h.jsxs)("h5",{children:["From:",Object(h.jsx)("span",{children:new Date(null===c||void 0===c?void 0:c.dateStart).toDateString()})]}),Object(h.jsxs)("h5",{children:["To:",Object(h.jsx)("span",{children:new Date(null===c||void 0===c?void 0:c.dateEnd).toDateString()})]}),Object(h.jsxs)("h5",{children:["No. of days:",Object(h.jsx)("span",{children:null===c||void 0===c?void 0:c.noOfDays})]})]}),Object(h.jsxs)("div",{className:"modal-footer",children:[Object(h.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(null===c||void 0===c?void 0:c._id,1,"Admin",null===c||void 0===c?void 0:c.noOfDays);case 2:e.sent?(O(!m),E.b.info("Accepted")):E.b.danger("Internal server error");case 4:case"end":return e.stop()}}),e)}))),children:"Accept"}),Object(h.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-dismiss":"modal",onClick:Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(null===c||void 0===c?void 0:c._id,2,"Admin",null===c||void 0===c?void 0:c.noOfDays);case 2:e.sent?(O(!m),E.b.info("Declined")):E.b.danger("Internal server error");case 4:case"end":return e.stop()}}),e)}))),children:"Decline"})]})]})})})]})]},e._id)}))})]})]})})},U=a(73);var B=function(){var e=JSON.parse(localStorage.getItem("storedUser")),t=Object(C.f)(),a=null===e||void 0===e?void 0:e.user,s=Object(n.useState)(!1),c=Object(o.a)(s,2),r=c[0],l=c[1],j=Object(n.useState)(0),b=Object(o.a)(j,2),m=b[0],v=b[1],f=Object(n.useState)(null),y=Object(o.a)(f,2),S=y[0],w=y[1],D=Object(n.useState)(null),A=Object(o.a)(D,2),I=A[0],L=A[1],P=Object(n.useState)(!0),k=Object(o.a)(P,2),F=k[0],q=k[1],H=Object(n.useState)(!1),M=Object(o.a)(H,2),T=M[0],R=M[1],J=Object(n.useState)([]),_=Object(o.a)(J,2),B=_[0],G=_[1],V=Object(n.useState)({}),Y=Object(o.a)(V,2),$=Y[0],W=Y[1],z=[],K=Object(n.useState)({userId:null===a||void 0===a?void 0:a._id,department:null===a||void 0===a?void 0:a.department,name:null===a||void 0===a?void 0:a.staffName}),Q=Object(o.a)(K,2),X=Q[0],Z=Q[1];Object(n.useEffect)((function(){for(var e=new Date(X.dateStart),t=new Date(X.dateEnd),n=0;e<=t;)n++,e=new Date(+e+864e5);var s=n;v(s),Z(Object(x.a)(Object(x.a)({},X),{},{noOfDays:s})),q(null===I),"Regular"===a.type?"Casual"===X.type&&m>a.regularStaffLeaves||"Earned"===X.type&&m>a.earnedLeaves?R(!0):R(!1):"Probation"===a.type&&("Casual"===X.type&&m>a.probationStaffLeaves?R(!0):R(!1))}),[S,I,m,X.type]),Object(n.useEffect)((function(){a||t("/login")}),[]),Object(n.useEffect)((function(){a&&ae()}),[r]);var ee=Object(n.useContext)(u),te=ee.userArr,ae=ee.getusers,ne=ee.postLeaveDetails,se=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),W(ce(X)),X.subject&&X.body&&X.type&&X.dateStart&&X.dateEnd){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,ne(X);case 6:(a=e.sent)?E.b.success(a.msg):E.b.error("Internal server error"),l(!r),ie(t);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(e){var t={};return e.subject||(t.subject="Subject is required"),e.type||(t.type="Type is required"),e.body||(t.body="Description is required"),e.dateStart||(t.dateStart="Start date is required"),e.subStaff||(t.subStaff="Substitue staff is required"),e.dateEnd||(t.dateEnd="End date is required"),t},re=function(e){Z(Object(x.a)(Object(x.a)({},X),{},Object(O.a)({},e.target.name,e.target.value))),"dateEnd"===e.target.name&&w(e.target.value),"dateStart"===e.target.name&&L(e.target.value)},le=te.filter((function(e){return"Staff"===(null===e||void 0===e?void 0:e.role)&&(null===e||void 0===e?void 0:e.staffName)!==(null===a||void 0===a?void 0:a.staffName)})),ie=function(e){Array.from(e.target).forEach((function(e){return e.value=""})),Z({userId:null===a||void 0===a?void 0:a._id,department:null===a||void 0===a?void 0:a.department,name:null===a||void 0===a?void 0:a.staffName}),G([]),v(0)},de=[];return le.map((function(e){return de.push({value:e.staffName,label:e.staffName})})),Object(n.useEffect)((function(){B.map((function(e){return z.push({name:e.value,status:0})})),Z(Object(x.a)(Object(x.a)({},X),{},{subStaffArr:z}))}),[B]),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"container leaveForm",children:[Object(h.jsx)("h1",{children:"Apply for a new leave"}),Object(h.jsx)("hr",{}),Object(h.jsxs)(p.a,{onSubmit:se,children:[Object(h.jsxs)(p.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(h.jsx)(p.a.Label,{className:"fs-3",children:"Subject"}),Object(h.jsx)(p.a.Control,{name:"subject",onChange:re,type:"text"}),Object(h.jsx)("p",{className:"text-danger",children:$.subject})]}),Object(h.jsxs)(p.a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[Object(h.jsxs)(p.a.Label,{className:"fs-3",children:["Description"," ",Object(h.jsx)("span",{className:"fs-6",children:"(Enter all the details of the leave including the reason and timings for substitute teachers)"})]}),Object(h.jsx)(p.a.Control,{onChange:re,as:"textarea",rows:3,name:"body"}),Object(h.jsx)("p",{className:"text-danger",children:$.body})]}),Object(h.jsx)(p.a.Label,{className:"fs-3",children:"Type of leave"}),Object(h.jsxs)(g.a,{controlId:"floatingSelect",label:"Select type of leave",children:[Object(h.jsxs)(p.a.Select,{"aria-label":"Floating label select example",onChange:re,name:"type",children:[Object(h.jsx)("option",{}),"required",Object(h.jsx)("option",{value:"Duty",children:"Duty"}),Object(h.jsx)("option",{value:"Casual",children:"Casual"}),"Regular"===a.type?Object(h.jsx)("option",{value:"Earned",children:"Earned"}):""]}),Object(h.jsx)("p",{className:"text-danger",children:$.type})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{className:"me-2 fs-4",children:"Start date:"}),Object(h.jsx)("input",{name:"dateStart",onChange:re,className:"mb-1",type:"date"}),Object(h.jsx)("span",{className:"text-danger",children:$.dateStart}),Object(h.jsx)("label",{className:" ms-2 fs-4",children:"End date:"}),Object(h.jsx)("input",{name:"dateEnd",onChange:re,className:"mb-1",type:"date",min:X.dateStart,disabled:F}),Object(h.jsx)("span",{className:"text-danger",children:$.dateEnd}),Object(h.jsxs)("label",{className:" ms-2 fs-4",children:["Number of days: ",m]}),Object(h.jsx)("span",{className:"ms-2 fs-5",id:"noOfDays",name:"noOfDays"})]}),Object(h.jsx)("label",{className:" my-2 fs-4",children:"Select substitute staff: "}),Object(h.jsx)(U.a,{options:de,value:B,hasSelectAll:!1,onChange:G}),Object(h.jsx)(N.a,{variant:"primary",disabled:T,className:"mt-4",type:"submit",children:"Submit"})]})]})})},G=a(123);var V=function(){var e=JSON.parse(localStorage.getItem("storedUser")),t=null===e||void 0===e?void 0:e.user,a=Object(C.f)();return Object(n.useEffect)((function(){t||a("/login")}),[]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"5rem"},children:Object(h.jsxs)(G.a,{style:{width:"25rem"},children:[Object(h.jsx)(G.a.Img,{variant:"top",src:"https://nd.net/wp-content/uploads/2016/04/profile-dummy.png",style:{width:"25rem",height:"25rem"}}),Object(h.jsxs)(G.a.Body,{children:[Object(h.jsxs)(G.a.Title,{children:["Name: ",null===t||void 0===t?void 0:t.staffName]}),Object(h.jsxs)(G.a.Title,{children:["Staff ID: ",null===t||void 0===t?void 0:t.staffId]}),Object(h.jsxs)(G.a.Title,{children:["Phone Number: ",null===t||void 0===t?void 0:t.phnumber]}),Object(h.jsxs)(G.a.Title,{children:["Email: ",null===t||void 0===t?void 0:t.email]}),Object(h.jsxs)(G.a.Title,{children:["Role: ",null===t||void 0===t?void 0:t.role]}),Object(h.jsxs)(G.a.Title,{children:["Joining date: ",new Date(null===t||void 0===t?void 0:t.joiningDate).toDateString()]}),"Regular"!==(null===t||void 0===t?void 0:t.type)?Object(h.jsxs)(G.a.Title,{children:["Probation leaves remaining: ",null===t||void 0===t?void 0:t.probationStaffLeaves]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(G.a.Title,{children:["Regular leaves remaining: ",null===t||void 0===t?void 0:t.regularStaffLeaves]}),Object(h.jsxs)(G.a.Title,{children:["Earned leaves remaining: ",null===t||void 0===t?void 0:t.earnedLeaves]})]})]})]})})})},Y=a(120),$=a(121);var W=function(){var e=Object(C.f)(),t=JSON.parse(localStorage.getItem("storedUser"));Object(n.useEffect)((function(){t||e("/login")}),[]);var a=null===t||void 0===t?void 0:t.user,s=Object(n.useState)({}),c=Object(o.a)(s,2),r=c[0],l=c[1],j=Object(n.useRef)(),u=Object(n.useRef)(),m=Object(n.useState)({}),p=Object(o.a)(m,2),v=p[0],f=p[1],g=function(e){var t={};return e.oldPassword||(t.oldPassword="Old password is required"),e.password||(t.password="Password is required"),t},y=function(e){l(Object(x.a)(Object(x.a)({},r),{},Object(O.a)({},e.target.name,e.target.value)))},S=function(){var e=Object(d.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(g(r)),u.current.value===j.current.value){e.next=5;break}E.b.warning("New passwords do not match"),e.next=15;break;case 5:return e.prev=5,e.next=8,b.a.put("http://localhost:4000/api/staff/".concat(a._id),r,{headers:{"content-Type":"application/json"}});case 8:e.sent.data.success?E.b.success("Password updated"):r.oldPassword&&r.password&&E.b.error("Incorrect old password"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:a?Object(h.jsxs)(Y.a,{bg:"light",expand:"lg",children:[Object(h.jsx)(Y.a.Brand,{className:"mx-4",to:"#home",children:"Leave management"}),Object(h.jsx)(Y.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(h.jsx)(Y.a.Collapse,{id:"basic-navbar-nav",children:Object(h.jsxs)($.a,{className:"me-auto",children:[Object(h.jsxs)("strong",{className:"navbar-text",children:["Hello, ",null===a||void 0===a?void 0:a.staffName]}),Object(h.jsx)($.a.Link,{as:J.b,to:"Admin"===(null===a||void 0===a?void 0:a.role)?"/admin":"Principal"!==a.role?"/":"/principal",children:"Home"}),"Admin"!==a.role&&Object(h.jsx)($.a.Link,{as:J.b,to:"/profile",children:"My profile"}),"Principal"!==a.role&&Object(h.jsx)($.a.Link,{as:J.b,to:"Admin"===(null===a||void 0===a?void 0:a.role)?"/leaveRequests":"/createLeave",children:"Admin"===(null===a||void 0===a?void 0:a.role)?"Incoming Leave Requests":"Create a new leave"}),"Hod"===a.role&&Object(h.jsx)($.a.Link,{as:J.b,to:"/viewStaff",children:"View Staff"})]})}),Object(h.jsx)(N.a,{className:"d-flex mx-4",variant:"primary",onClick:function(){localStorage.removeItem("storedUser"),e("/login")},children:"Logout"}),Object(h.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#exampleModal",children:"Change Password"}),Object(h.jsx)("div",{className:"modal fade",id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(h.jsx)("div",{className:"modal-dialog",children:Object(h.jsxs)("div",{className:"modal-content",children:[Object(h.jsxs)("div",{className:"modal-header",children:[Object(h.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Change Password"}),Object(h.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(h.jsxs)("div",{className:"modal-body",children:[Object(h.jsx)("label",{children:"Old Password:"}),Object(h.jsx)("input",{name:"oldPassword",className:"pwdBox",onChange:y,type:"text"}),Object(h.jsx)("p",{className:"text-danger",children:v.oldPassword}),Object(h.jsx)("label",{children:"New Password:"}),Object(h.jsx)("input",{name:"password",onChange:y,type:"password",className:"pwdBox",ref:j}),Object(h.jsx)("p",{className:"text-danger",children:v.password}),Object(h.jsx)("label",{children:"New Password again:"}),Object(h.jsx)("input",{ref:u,type:"password",className:"pwdBox"})]}),Object(h.jsxs)("div",{className:"modal-footer",children:[Object(h.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"}),Object(h.jsx)("button",{type:"button",className:"btn btn-primary",onClick:S,children:"Save changes"})]})]})})})]}):Object(h.jsx)(Y.a,{bg:"light",expand:"lg",children:Object(h.jsx)(Y.a.Brand,{className:"mx-4",to:"#home",children:"Leave management"})})})};var z=function(){var e=Object(C.f)(),t=Object(n.useContext)(u),a=Object(n.useState)([]),s=Object(o.a)(a,2),c=s[0],r=s[1],l=t.getusers,j=JSON.parse(localStorage.getItem("storedUser")),b=null===j||void 0===j?void 0:j.user;return Object(n.useEffect)((function(){"Hod"!==(null===b||void 0===b?void 0:b.role)&&e("/login")}),[]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Hod"!==(null===b||void 0===b?void 0:b.role)){e.next=5;break}return e.next=3,l();case 3:(t=e.sent)?(a=null===t||void 0===t?void 0:t.filter((function(e){return e.department===b.department})),r(a)):E.b.error("Internal Server Error");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"container center",children:[Object(h.jsxs)("h1",{className:"my-4 text-center",children:[b.department," Staff"]}),Object(h.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Staff ID"}),Object(h.jsx)("th",{children:"Full Name"}),Object(h.jsx)("th",{children:"Email "}),Object(h.jsx)("th",{children:"Phone Number"}),Object(h.jsx)("th",{children:"Role"}),Object(h.jsx)("th",{children:"Type"}),Object(h.jsx)("th",{children:"Leaves remaining"}),Object(h.jsx)("th",{children:"Department"})]})}),Object(h.jsx)("tbody",{children:c.map((function(e){return Object(h.jsx)("tr",{children:"Principal"!==e.role&&"Admin"!==e.role&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("td",{children:e.staffId}),Object(h.jsx)("td",{children:e.staffName}),Object(h.jsx)("td",{children:e.email}),Object(h.jsx)("td",{children:e.phnumber}),Object(h.jsx)("td",{children:e.role}),Object(h.jsx)("td",{children:e.type}),Object(h.jsx)("td",{children:"Regular"===e.type?Object(h.jsx)("span",{children:e.earnedLeaves+e.regularStaffLeaves}):Object(h.jsx)("span",{children:e.probationStaffLeaves})}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{children:e.department})})]})},e.staffId)}))})]})]})})};var K=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(E.a,{position:"bottom-right",autoClose:2e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0}),Object(h.jsxs)(J.a,{children:[Object(h.jsx)(W,{}),Object(h.jsxs)(C.c,{children:[Object(h.jsx)(C.a,{path:"/login",element:Object(h.jsx)(A,{})}),Object(h.jsx)(C.a,{path:"/",element:Object(h.jsx)(R,{})}),Object(h.jsx)(C.a,{path:"/admin",element:Object(h.jsx)(D,{})}),Object(h.jsx)(C.a,{path:"/principal",element:Object(h.jsx)(I,{})}),Object(h.jsx)(C.a,{path:"/leaveRequests",element:Object(h.jsx)(_,{})}),Object(h.jsx)(C.a,{path:"/createLeave",element:Object(h.jsx)(B,{})}),Object(h.jsx)(C.a,{path:"/profile",element:Object(h.jsx)(V,{})}),Object(h.jsx)(C.a,{path:"/viewStaff",element:Object(h.jsx)(z,{})})]})]})]})};r.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(m,{children:Object(h.jsx)(K,{})})}),document.getElementById("root"))},35:function(e,t,a){}},[[109,1,2]]]);
//# sourceMappingURL=main.74c74123.chunk.js.map