(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{109:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),c=a(23),r=a.n(c),l=(a(79),a(8)),i=a.n(l),d=a(11),o=a(3),j=a(16),b=a.n(j),u=Object(s.createContext)(),m=a(0);var h=function(e){var t=Object(s.useState)([]),a=Object(o.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)([]),l=Object(o.a)(r,2),j=l[0],h=l[1],x=Object(s.useState)([]),O=Object(o.a)(x,2),p=O[0],v=O[1],f=Object(s.useState)([]),g=Object(o.a)(f,2),N=g[0],y=g[1],S=Object(s.useState)([]),w=Object(o.a)(S,2),D=w[0],C=w[1],E=Object(s.useState)([]),I=Object(o.a)(E,2),A=I[0],L=I[1],P=function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/staff/fetchusers");case 3:t=e.sent,c(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("http://localhost:4000/api/leave/",t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(d.a)(i.a.mark((function e(t,a,s,n,c){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.put("http://localhost:4000/api/leave/".concat(t,"/").concat(a,"/").concat(s,"/").concat(n,"/").concat(c));case 3:return r=e.sent,e.abrupt("return",r.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a,s,n,c){return e.apply(this,arguments)}}(),F=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.delete("http://localhost:4000/api/staff/".concat(t));case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.delete("http://localhost:4000/api/leave/".concat(t));case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/staff/".concat(t));case 3:a=e.sent,h(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/".concat(t));case 3:a=e.sent,v(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/hod/".concat(t));case 3:a=e.sent,y(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/");case 3:t=e.sent,C(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("http://localhost:4000/api/auth/login",t,{headers:{"Content-Type":"application/json"}});case 3:return a=e.sent,localStorage.setItem("storedUser",JSON.stringify(a.data)),e.abrupt("return",a.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:4000/api/leave/principal/allLeaves");case 3:t=e.sent,L(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(m.jsx)(u.Provider,{value:{getusers:P,userArr:n,deleteUser:F,postLeaveDetails:k,recievedRequests:H,recievedLeaveArr:j,myRequestedLeaves:R,requestedLeavesArr:p,staffStatus:q,requestesForHod:M,requestesForHodArr:N,requestsForAdmin:_,requestsForAdminArr:D,login:J,deleteLeave:T,getAllLeaves:U,allLeavesArr:A},children:e.children})},x=a(7),O=a(2),p=a(122),v=a(117),f=a(64),g=a(65),N=a(118),y=a(119),S=a(66),w=a.n(S),D=a(9),C=a(12);var E=function(){var e=Object(s.useState)(!1),t=Object(o.a)(e,2),a=t[0],n=t[1],c=Object(s.useState)(!0),r=Object(o.a)(c,2),l=r[0],j=r[1],h=Object(s.useState)({}),S=Object(o.a)(h,2),E=S[0],I=S[1],A=Object(s.useState)({}),L=Object(o.a)(A,2),P=L[0],k=L[1],q=Object(s.useContext)(u),F=q.getusers,T=q.userArr,H=q.deleteUser,R=Object(D.f)(),M=JSON.parse(localStorage.getItem("storedUser")),_=null===M||void 0===M?void 0:M.user;Object(s.useEffect)((function(){"Admin"===(null===_||void 0===_?void 0:_.role)&&null!==M||R("/login")}),[]);var J=function(e){var t={};return e.staffId||(t.staffId="Staff Id is required "),e.staffName||(t.staffName="Staff name  is required "),e.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(t.email="Enter a valid email address"):t.email="Email id  is required ",e.password||(t.password="Password  is required "),e.joiningDate||(t.joiningDate="Joining date  is required "),e.phnumber?/^[+]?[(]?[0-9]{3}[)]?[-\s.]?[0-9]{3}[-\s.]?[0-9]{4,6}$/im.test(e.phnumber)||(t.phnumber="Enter a valid phone number"):t.phnumber="Phone number  is required ",e.role||(t.role="Role is required "),e.type||(t.type="Type  is required "),"Principal"!==e.role&&(e.department||(t.department="department  is required ")),t};Object(s.useEffect)((function(){"Admin"===(null===_||void 0===_?void 0:_.role)&&F()}),[a]);var U=function(){var e=Object(d.a)(i.a.mark((function e(t){var s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),k(J(E)),E.staffId&&E.staffName&&E.email&&E.joiningDate&&E.password&&E.phnumber&&"Principal"!==E.role?E.type&&E.department:E.type){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,b.a.post("http://localhost:4000/api/auth/register",E);case 7:!1===(s=e.sent).data.success?C.b.error(s.data.msg):s.data.success&&C.b.success("user successfully created"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:n(!a);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(d.a)(i.a.mark((function e(t){var s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,H(t._id);case 3:(s=e.sent)?C.b.success(s):C.b.error("internal server error"),n(!a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(e){"Staff"===E.role||"Hod"===E.role?j(!1):j(!0),I(Object(O.a)(Object(O.a)({},E),{},Object(x.a)({},e.target.name,e.target.value)))};return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"container my-5",children:[Object(m.jsx)("h1",{children:"Create a new staff member"}),Object(m.jsx)("hr",{}),Object(m.jsxs)(p.a,{onSubmit:U,children:[Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Staff ID"}),Object(m.jsxs)(f.a,{sm:"10",children:[Object(m.jsx)(p.a.Control,{onChange:B,name:"staffId",type:"text",placeholder:"Staff Id"}),Object(m.jsx)("p",{className:"text-danger",children:P.staffId})]})]}),Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Staff Name"}),Object(m.jsxs)(f.a,{sm:"10",children:[Object(m.jsx)(p.a.Control,{onChange:B,name:"staffName",type:"text",placeholder:"Staff Name"}),Object(m.jsx)("p",{className:"text-danger",children:P.staffName})]})]}),Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Email"}),Object(m.jsxs)(f.a,{sm:"10",children:[Object(m.jsx)(p.a.Control,{onChange:B,type:"email",name:"email",placeholder:"Email"}),Object(m.jsx)("p",{className:"text-danger",children:P.email})]})]}),Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Password"}),Object(m.jsxs)(f.a,{sm:"10",children:[Object(m.jsx)(p.a.Control,{onChange:B,type:"Password",name:"password",placeholder:"Password"}),Object(m.jsx)("p",{className:"text-danger",children:P.password})]})]}),Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Joining Date"}),Object(m.jsxs)(f.a,{sm:"10",children:[Object(m.jsx)(p.a.Control,{onChange:B,type:"date",name:"joiningDate"})," ",Object(m.jsx)("p",{className:"text-danger",children:P.joiningDate})]})]}),Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Phone Number"}),Object(m.jsxs)(f.a,{sm:"10",children:[Object(m.jsx)(p.a.Control,{onChange:B,type:"tel",name:"phnumber",placeholder:"Phone Number"}),Object(m.jsx)("p",{className:"text-danger",children:P.phnumber})]})]}),Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Role"}),Object(m.jsx)(f.a,{sm:"10",children:Object(m.jsxs)(g.a,{controlId:"floatingSelect",label:"Select a role",children:[Object(m.jsxs)(p.a.Select,{"aria-label":"Floating label select example",name:"role",onChange:B,children:[Object(m.jsx)("option",{}),Object(m.jsx)("option",{value:"Hod",children:"Hod"}),Object(m.jsx)("option",{value:"Staff",children:"Staff"}),Object(m.jsx)("option",{value:"Principal",children:"Principal"})]})," ",Object(m.jsx)("p",{className:"text-danger",children:P.role})]})})]}),Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Type"}),Object(m.jsx)(f.a,{sm:"10",children:Object(m.jsxs)(g.a,{controlId:"floatingSelect",label:"Select type of Staff",children:[Object(m.jsxs)(p.a.Select,{"aria-label":"Floating label select example",name:"type",onChange:B,children:[Object(m.jsx)("option",{children:" "}),Object(m.jsx)("option",{value:"Regular",children:"Regular"}),Object(m.jsx)("option",{value:"Probation",children:"Probation"})]})," ",Object(m.jsx)("p",{className:"text-danger",children:P.type})]})})]}),Object(m.jsxs)(p.a.Group,{as:v.a,className:"mb-3",controlId:"formPlaintextPassword",children:[Object(m.jsx)(p.a.Label,{column:!0,sm:"2",children:"Department"}),Object(m.jsx)(f.a,{sm:"10",children:Object(m.jsxs)(g.a,{controlId:"floatingSelect",label:"Select a department",children:[Object(m.jsxs)(p.a.Select,{"aria-label":"Floating label select example",name:"department",disabled:l,onChange:B,children:[Object(m.jsx)("option",{}),Object(m.jsx)("option",{value:"CSE",children:"CSE"}),Object(m.jsx)("option",{value:"ECE",children:"ECE"}),Object(m.jsx)("option",{value:"EEE",children:"EEE"}),Object(m.jsx)("option",{value:"CIV",children:"CIV"}),Object(m.jsx)("option",{value:"PHY",children:"PHY"}),Object(m.jsx)("option",{value:"CHEM",children:"CHEM"}),Object(m.jsx)("option",{value:"MATH",children:"MATH"}),Object(m.jsx)("option",{value:"OFFICE",children:"OFFICE"}),Object(m.jsx)("option",{value:"MBA",children:"MBA"}),Object(m.jsx)("option",{value:"MCA",children:"MCA"})]})," ",Object(m.jsx)("p",{className:"text-danger",children:P.department})]})})]}),Object(m.jsx)(p.a.Group,{children:Object(m.jsx)(N.a,{variant:"primary",type:"submit",children:"Submit"})}),Object(m.jsx)("hr",{})]}),Object(m.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"Staff ID"}),Object(m.jsx)("th",{children:"Full Name"}),Object(m.jsx)("th",{children:"Email "}),Object(m.jsx)("th",{children:"Phone Number"}),Object(m.jsx)("th",{children:"Role"}),Object(m.jsx)("th",{children:"Type"}),Object(m.jsx)("th",{children:"Leaves remaining"}),Object(m.jsx)("th",{children:"Department"})]})}),Object(m.jsx)("tbody",{children:T.map((function(e){return Object(m.jsx)("tr",{children:"Admin"!==e.role&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("td",{children:e.staffId}),Object(m.jsx)("td",{children:e.staffName}),Object(m.jsx)("td",{children:e.email}),Object(m.jsx)("td",{children:e.phnumber}),Object(m.jsx)("td",{children:e.role}),Object(m.jsx)("td",{children:e.type}),Object(m.jsx)("td",{children:"Regular"===e.type?Object(m.jsx)("span",{children:e.earnedLeaves+e.regularStaffLeaves}):Object(m.jsx)("span",{children:e.probationStaffLeaves})}),Object(m.jsxs)("td",{style:{display:"flex",justifyContent:"space-between",cursor:"pointer"},children:[Object(m.jsx)("span",{children:e.department}),Object(m.jsx)("span",{onClick:function(){return G(e)},children:Object(m.jsx)(w.a,{})})]})]})},e.staffId)}))})]})]})})};a(53);var I=function(){var e=Object(s.useContext)(u),t=Object(D.f)(),a=e.login,n=Object(s.useState)({}),c=Object(o.a)(n,2),r=c[0],l=c[1],j=Object(s.useState)({}),b=Object(o.a)(j,2),h=b[0],p=b[1];Object(s.useEffect)((function(){localStorage.removeItem("storedUser");var e=sessionStorage.getItem("reloadCount");e<1?(sessionStorage.setItem("reloadCount",String(e+1)),window.location.reload()):sessionStorage.removeItem("reloadCount")}),[]);var v=function(e){l(Object(O.a)(Object(O.a)({},r),{},Object(x.a)({},e.target.name,e.target.value)))},f=function(){var e=Object(d.a)(i.a.mark((function e(s){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),p(g(r)),!r.email||!r.password){e.next=7;break}return e.next=5,a(r);case 5:e.sent?(null===(n=JSON.parse(localStorage.getItem("storedUser")))||void 0===n?void 0:n.success)?"Staff"===(null===(c=null===n||void 0===n?void 0:n.user)||void 0===c?void 0:c.role)||"Hod"===(null===c||void 0===c?void 0:c.role)?t("/"):"Principal"===(null===c||void 0===c?void 0:c.role)?t("/principal"):"Admin"===(null===c||void 0===c?void 0:c.role)&&t("/admin"):r.email&&r.password&&C.b.error("Wrong credentials"):C.b.error("internal server error");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e){var t={};return e.email||(t.email="Email is required"),e.password||(t.password="Password is required"),t};return Object(m.jsx)("div",{className:"vertical-center",children:Object(m.jsx)("div",{className:" container border border-dark rounded",style:{padding:"1rem",width:"30%"},children:Object(m.jsxs)("form",{className:"requires-validation",onSubmit:f,children:[Object(m.jsxs)("div",{className:"mb-3",children:[Object(m.jsxs)("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:["Email address ",Object(m.jsx)("span",{className:"text-danger",children:" *"})]}),Object(m.jsx)("input",{type:"email",name:"email",onChange:v,className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp"}),Object(m.jsx)("p",{className:"text-danger",children:h.email})]}),Object(m.jsxs)("div",{className:"mb-3",children:[Object(m.jsxs)("label",{htmlFor:"exampleInputPassword1",className:"form-label",children:["Password ",Object(m.jsx)("span",{className:"text-danger",children:" *"})]}),Object(m.jsx)("input",{type:"password",name:"password",onChange:v,className:"form-control",id:"exampleInputPassword1"}),Object(m.jsx)("p",{className:"text-danger",children:h.password})]}),Object(m.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Login"})]})})})};a(35);var A=function(){var e=Object(D.f)(),t=Object(s.useContext)(u),a=t.userArr,n=t.getusers,c=t.getAllLeaves,r=t.allLeavesArr;Object(s.useEffect)((function(){"Principal"===(null===i||void 0===i?void 0:i.role)&&null!==l||e("/login")}),[]),Object(s.useEffect)((function(){n(),c()}),[]);var l=JSON.parse(localStorage.getItem("storedUser")),i=null===l||void 0===l?void 0:l.user;Object(s.useEffect)((function(){"Principal"!==(null===i||void 0===i?void 0:i.role)&&e("/login")}),[]);var d=new Date,o=[];return null===r||void 0===r||r.forEach((function(e){var t=new Date(e.dateStart),a=new Date(e.dateEnd);d.getDate()<=a.getDate()&&d.getDate()>=t.getDate()&&o.push(e)})),console.log(o),Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"container center",children:[Object(m.jsxs)("div",{className:"card my-4",style:{width:"20rem",margin:"auto"},children:[Object(m.jsx)("div",{className:"card-header",children:(new Date).toDateString()}),Object(m.jsxs)("ul",{className:"list-group list-group-flush",children:[Object(m.jsxs)("a",{className:"list-group-item ","data-bs-toggle":"collapse",href:"#collapseExample",role:"button","aria-expanded":"false","aria-controls":"collapseExample",children:["Number of staff on leave today: ",o.length]}),Object(m.jsx)("div",{className:"collapse",id:"collapseExample",children:Object(m.jsx)("div",{className:"card card-body",style:{padding:"0.1rem 0 0.1rem 0"},children:o.map((function(e){return Object(m.jsx)("ul",{className:"list-group list-group-flush ",children:Object(m.jsx)("li",{className:"list-group-item",style:{textAlign:"left"},children:Object(m.jsx)("span",{children:null===e||void 0===e?void 0:e.name})})},e.name)}))})})]})]}),Object(m.jsx)("h1",{className:"my-4 text-center",children:"Jain College of Engineering Staff Details"}),Object(m.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"Staff ID"}),Object(m.jsx)("th",{children:"Full Name"}),Object(m.jsx)("th",{children:"Email "}),Object(m.jsx)("th",{children:"Phone Number"}),Object(m.jsx)("th",{children:"Role"}),Object(m.jsx)("th",{children:"Type"}),Object(m.jsx)("th",{children:"Leaves remaining"}),Object(m.jsx)("th",{children:"Department"})]})}),Object(m.jsx)("tbody",{children:a.map((function(e){return Object(m.jsx)("tr",{children:"Principal"!==e.role&&"Admin"!==e.role&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("td",{children:e.staffId}),Object(m.jsx)("td",{children:e.staffName}),Object(m.jsx)("td",{children:e.email}),Object(m.jsx)("td",{children:e.phnumber}),Object(m.jsx)("td",{children:e.role}),Object(m.jsx)("td",{children:e.type}),Object(m.jsx)("td",{children:"Regular"===e.type?Object(m.jsx)("span",{children:e.earnedLeaves+e.regularStaffLeaves}):Object(m.jsx)("span",{children:e.probationStaffLeaves})}),Object(m.jsx)("td",{children:Object(m.jsx)("span",{children:e.department})})]})},e.staffId)}))})]})]})})},L=a(13),P=a(68),k=a.n(P),q=a(69),F=a.n(q),T=a(70),H=a.n(T);var R=function(){var e=JSON.parse(localStorage.getItem("storedUser")),t=null===e||void 0===e?void 0:e.user,a=Object(s.useState)(!1),n=Object(o.a)(a,2),c=n[0],r=n[1],l=Object(s.useState)({}),j=Object(o.a)(l,2),b=j[0],h=j[1],x=Object(s.useState)([]),O=Object(o.a)(x,2),p=O[0],v=O[1],f=Object(s.useState)({}),g=Object(o.a)(f,2),N=g[0],S=g[1],w=Object(s.useContext)(u),E=Object(D.f)(),I=w.recievedLeaveArr,A=w.recievedRequests,P=w.requestedLeavesArr,q=w.myRequestedLeaves,T=w.staffStatus,R=w.requestesForHod,M=w.requestesForHodArr;Object(s.useEffect)((function(){"Admin"!==(null===t||void 0===t?void 0:t.role)&&"Principal"!==(null===t||void 0===t?void 0:t.role)||E("/login")}),[]),Object(s.useEffect)((function(){"Staff"!==(null===t||void 0===t?void 0:t.role)&&"Hod"!==(null===t||void 0===t?void 0:t.role)||q(null===t||void 0===t?void 0:t._id),"Staff"===(null===t||void 0===t?void 0:t.role)?A(null===t||void 0===t?void 0:t.staffName):"Hod"===(null===t||void 0===t?void 0:t.role)&&R(null===t||void 0===t?void 0:t.department)}),[c]);var _=0,J=function(e){h(e)};return Object(m.jsxs)("div",{className:"leaveReqDiv",children:[Object(m.jsx)("div",{className:"myRequests",children:Object(m.jsxs)("div",{className:"tableRequests",children:[Object(m.jsx)("h1",{children:"My leave requests"}),Object(m.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{className:"theads",children:[Object(m.jsx)("th",{children:"S.No"}),Object(m.jsx)("th",{children:"Subject"}),Object(m.jsx)("th",{children:"From"}),Object(m.jsx)("th",{children:"To"}),Object(m.jsx)("th",{children:"Staff-status"}),"Staff"===(null===t||void 0===t?void 0:t.role)?Object(m.jsx)("th",{children:"Hod-status"}):Object(m.jsx)("th",{children:"Admin-status"}),Object(m.jsx)("th",{children:"View Leave"})]})}),Object(m.jsx)("tbody",{children:Object(L.a)(P).reverse().map((function(e){return Object(m.jsxs)("tr",{className:"theads",children:[Object(m.jsx)("td",{children:_+=1}),Object(m.jsx)("td",{children:e.subject}),Object(m.jsx)("td",{children:new Date(e.dateStart).toDateString()}),Object(m.jsx)("td",{children:new Date(e.dateEnd).toDateString()}),Object(m.jsxs)("td",{children:[1!==e.byStaff&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#byStaffApproval",onClick:function(){return function(e){v(e.subStaffArr)}(e)},children:"view"}),Object(m.jsx)("div",{className:"modal fade",id:"byStaffApproval",tabIndex:"-1","aria-labelledby":"byStaffApprovalLabel","aria-hidden":"true",children:Object(m.jsx)("div",{className:"modal-dialog",children:Object(m.jsxs)("div",{className:"modal-content",children:[Object(m.jsxs)("div",{className:"modal-header",children:[Object(m.jsx)("h5",{className:"modal-title",id:"byStaffApprovalLabel",children:"Your substitute staff requests"}),Object(m.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(m.jsx)("div",{className:"modal-body",children:null===p||void 0===p?void 0:p.map((function(e){return Object(m.jsxs)("div",{style:{display:"flex"},children:[Object(m.jsxs)("h5",{children:["Name:",Object(m.jsx)("span",{children:null===e||void 0===e?void 0:e.name})]}),Object(m.jsxs)("h5",{className:"mx-2",children:["Status:",1===(null===e||void 0===e?void 0:e.status)&&Object(m.jsx)("span",{className:"text-success fw-bold",children:Object(m.jsx)(k.a,{})})||0===(null===e||void 0===e?void 0:e.status)&&Object(m.jsx)("span",{className:"text-warning fw-bold",children:Object(m.jsx)(F.a,{})})||2===(null===e||void 0===e?void 0:e.status)&&Object(m.jsx)("span",{className:"text-danger fw-bold",children:Object(m.jsx)(H.a,{})})]})]},e.name)}))}),Object(m.jsx)("div",{className:"modal-footer",children:Object(m.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})})]}),1===e.byStaff&&Object(m.jsx)("span",{className:"text-success fw-bold",children:"Approved"})]}),Object(m.jsxs)("td",{children:["Staff"===t.role?0===e.byHod&&Object(m.jsx)("span",{className:"text-warning fw-bold",children:"Pending..."}):0===e.byAdmin&&Object(m.jsx)("span",{className:"text-warning fw-bold",children:"Pending..."}),"Staff"===t.role?1===e.byHod&&Object(m.jsx)("span",{className:"text-success fw-bold",children:"Approved"}):1===e.byAdmin&&Object(m.jsx)("span",{className:"text-success fw-bold",children:"Approved"}),"Hod"!==t.role?2===e.byHod&&Object(m.jsx)("span",{className:"text-danger fw-bold",children:"Declined"}):2===e.byAdmin&&Object(m.jsx)("span",{className:"text-danger fw-bold",children:"Declined"})]}),Object(m.jsx)("td",{children:Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#viewInDetail",onClick:function(){return function(e){S(e)}(e)},children:"view"}),Object(m.jsx)("div",{className:"modal fade",id:"viewInDetail",tabIndex:"-1","aria-labelledby":"viewInDetailLabel","aria-hidden":"true",children:Object(m.jsx)("div",{className:"modal-dialog",children:Object(m.jsxs)("div",{className:"modal-content",children:[Object(m.jsxs)("div",{className:"modal-header",children:[Object(m.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Leave request details"}),Object(m.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(m.jsxs)("div",{className:"modal-body",style:{textAlign:"left"},children:[Object(m.jsxs)("h5",{children:["Subject:",Object(m.jsx)("span",{children:null===N||void 0===N?void 0:N.subject})]}),Object(m.jsxs)("h5",{children:["Description:",Object(m.jsx)("span",{children:null===N||void 0===N?void 0:N.body})]}),Object(m.jsxs)("h5",{children:["Type:",Object(m.jsx)("span",{children:null===N||void 0===N?void 0:N.type})]}),Object(m.jsxs)("h5",{children:["From:",Object(m.jsx)("span",{children:new Date(null===N||void 0===N?void 0:N.dateStart).toDateString()})]}),Object(m.jsxs)("h5",{children:["To:",Object(m.jsx)("span",{children:new Date(null===N||void 0===N?void 0:N.dateEnd).toDateString()})]}),Object(m.jsxs)("h5",{children:["No. of days:",Object(m.jsx)("span",{children:null===N||void 0===N?void 0:N.noOfDays})]})]}),Object(m.jsx)("div",{className:"modal-footer",children:Object(m.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})})]})})]},e._id)}))})]})]})}),Object(m.jsxs)("div",{className:"recievedRequests",children:[Object(m.jsx)("h1",{children:"Substitution requests"}),Object(m.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"Full Name"}),Object(m.jsx)("th",{children:"Subject"}),Object(m.jsx)("th",{children:"Start date"}),Object(m.jsx)("th",{children:"End date"}),Object(m.jsx)("th",{children:"Accept/Decline"})]})}),"Staff"===(null===t||void 0===t?void 0:t.role)?Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("tbody",{children:Object(L.a)(I).reverse().map((function(e){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{className:"center",children:e.name}),Object(m.jsx)("td",{className:"center",children:e.subject}),Object(m.jsx)("td",{className:"center",children:new Date(e.dateStart).toDateString()}),Object(m.jsx)("td",{className:"center",children:new Date(e.dateEnd).toDateString()}),Object(m.jsxs)("td",{style:{display:"flex",justifyContent:"space-around",cursor:"pointer"},children:[e.subStaffArr.some((function(e){return e.name===t.staffName&&0===e.status}))?Object(m.jsx)("button",{type:"button",className:"btn btn-primary ","data-bs-toggle":"modal","data-bs-target":"#bbb",onClick:function(){return J(e)},children:"View"}):Object(m.jsx)("span",{children:e.subStaffArr.some((function(e){return e.name===t.staffName&&1===e.status}))?Object(m.jsx)("span",{className:"text-success",children:"Accepted"}):Object(m.jsx)("span",{className:"text-danger",children:"Declined"})}),Object(m.jsx)("div",{className:"modal fade",id:"bbb",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(m.jsx)("div",{className:"modal-dialog",children:Object(m.jsxs)("div",{className:"modal-content",children:[Object(m.jsxs)("div",{className:"modal-header",children:[Object(m.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Leave request details"}),Object(m.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(m.jsxs)("div",{className:"modal-body ",children:[Object(m.jsxs)("h5",{children:["Name:",Object(m.jsx)("span",{children:null===b||void 0===b?void 0:b.name})]}),Object(m.jsxs)("h5",{children:["Subject:",Object(m.jsx)("span",{children:null===b||void 0===b?void 0:b.subject})]}),Object(m.jsxs)("h5",{children:["Description:",Object(m.jsx)("span",{children:null===b||void 0===b?void 0:b.body})]}),Object(m.jsxs)("h5",{children:["From:",Object(m.jsx)("span",{children:new Date(null===b||void 0===b?void 0:b.dateStart).toDateString()})]}),Object(m.jsxs)("h5",{children:["To:",Object(m.jsx)("span",{children:new Date(null===b||void 0===b?void 0:b.dateEnd).toDateString()})]})]}),Object(m.jsxs)("div",{className:"modal-footer",children:[Object(m.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(null===b||void 0===b?void 0:b._id,1,null===t||void 0===t?void 0:t.role,null===b||void 0===b?void 0:b.noOfDays,null===t||void 0===t?void 0:t.staffName);case 2:e.sent?(r(!c),C.b.info("Accepted")):C.b.danger("Internal server error");case 4:case"end":return e.stop()}}),e)}))),children:"Accept"}),Object(m.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-dismiss":"modal",onClick:Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(null===b||void 0===b?void 0:b._id,2,null===t||void 0===t?void 0:t.role,null===b||void 0===b?void 0:b.noOfDays,null===t||void 0===t?void 0:t.staffName);case 2:e.sent?(r(!c),C.b.info("Declined")):C.b.danger("Internal server error");case 4:case"end":return e.stop()}}),e)}))),children:"Decline"})]})]})})})]})]},e._id)}))})}):Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("tbody",{children:Object(L.a)(M).reverse().map((function(e){return Object(m.jsx)("tr",{children:e.userId!==t._id&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("td",{className:"center",children:e.name}),Object(m.jsx)("td",{className:"center",children:e.subject}),Object(m.jsx)("td",{className:"center",children:new Date(e.dateStart).toDateString()}),Object(m.jsx)("td",{className:"center",children:new Date(e.dateEnd).toDateString()}),Object(m.jsxs)("td",{style:{display:"flex",justifyContent:"space-around",cursor:"pointer"},children:[0===e.byHod?Object(m.jsx)("button",{type:"button",className:"btn btn-primary ","data-bs-toggle":"modal","data-bs-target":"#aaa",onClick:function(){return J(e)},children:"View"}):Object(m.jsx)("span",{children:1===e.byHod?Object(m.jsx)("span",{className:"text-success",children:"Accepted"}):Object(m.jsx)("span",{className:"text-danger",children:"Declined"})}),Object(m.jsx)("div",{className:"modal fade",id:"aaa",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(m.jsx)("div",{className:"modal-dialog",children:Object(m.jsxs)("div",{className:"modal-content",children:[Object(m.jsxs)("div",{className:"modal-header",children:[Object(m.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Leave request details"}),Object(m.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(m.jsxs)("div",{className:"modal-body",children:[Object(m.jsxs)("h5",{children:["Name:",Object(m.jsx)("span",{children:null===b||void 0===b?void 0:b.name})]}),Object(m.jsxs)("h5",{children:["Subject:",Object(m.jsx)("span",{children:null===b||void 0===b?void 0:b.subject})]}),Object(m.jsxs)("h5",{children:["Description:",Object(m.jsx)("span",{children:null===b||void 0===b?void 0:b.body})]}),Object(m.jsxs)("h5",{children:["From:",Object(m.jsx)("span",{children:new Date(null===b||void 0===b?void 0:b.dateStart).toDateString()})]}),Object(m.jsxs)("h5",{children:["To:",Object(m.jsx)("span",{children:new Date(null===b||void 0===b?void 0:b.dateEnd).toDateString()})]})]}),Object(m.jsxs)("div",{className:"modal-footer",children:[Object(m.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:function(){T(b._id,1,null===t||void 0===t?void 0:t.role,null===b||void 0===b?void 0:b.noOfDays,null===t||void 0===t?void 0:t.staffName),r(!c),C.b.info("Accepted")},children:"Accept"}),Object(m.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-dismiss":"modal",onClick:function(){T(b._id,2,null===t||void 0===t?void 0:t.role,null===b||void 0===b?void 0:b.noOfDays,null===t||void 0===t?void 0:t.staffName),r(!c),C.b.info("Declined")},children:"Decline"})]})]})})})]})]})},e._id)}))})})]})]})]})};var M=function(){var e=Object(D.f)();return Object(s.useEffect)((function(){localStorage.getItem("storedUser")||e("/login")}),[]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(R,{})})},_=a(18);var J=function(){var e,t=Object(D.f)(),a=Object(s.useState)({}),n=Object(o.a)(a,2),c=n[0],r=n[1],l=Object(s.useContext)(u),i=Object(s.useState)(!1),d=Object(o.a)(i,2),j=d[0],b=d[1],h=l.requestsForAdmin,x=l.requestsForAdminArr,O=l.staffStatus,p=JSON.parse(localStorage.getItem("storedUser")),v=null===p||void 0===p?void 0:p.user;return Object(s.useEffect)((function(){"Admin"!==(null===v||void 0===v?void 0:v.role)&&t("/login")}),[]),Object(s.useEffect)((function(){v&&h()}),[j]),Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"container my-5",children:[Object(m.jsx)("h1",{className:"text-center mb-3",children:"Incoming leave applications"}),Object(m.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{className:"theads",children:[Object(m.jsx)("th",{children:"Full Name"}),Object(m.jsx)("th",{children:"Subject"}),Object(m.jsx)("th",{children:"Start date"}),Object(m.jsx)("th",{children:"End date"}),Object(m.jsx)("th",{children:"Accept/Decline"})]})}),Object(m.jsx)("tbody",{children:null===(e=Object(L.a)(x).reverse())||void 0===e?void 0:e.map((function(e){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{className:"center",children:e.name}),Object(m.jsx)("td",{className:"center",children:e.subject}),Object(m.jsx)("td",{className:"center",children:new Date(e.dateStart).toDateString()}),Object(m.jsx)("td",{className:"center",children:new Date(e.dateEnd).toDateString()}),Object(m.jsxs)("td",{style:{display:"flex",justifyContent:"space-around",cursor:"pointer"},children:[0===e.byAdmin?Object(m.jsx)("button",{type:"button",className:"btn btn-primary ","data-bs-toggle":"modal","data-bs-target":"#aaa",onClick:function(){r(e)},children:"View"}):Object(m.jsx)("span",{children:1===e.byAdmin?Object(m.jsx)("span",{className:"text-success",children:"Accepted"}):Object(m.jsx)("span",{className:"text-danger",children:"Declined"})}),Object(m.jsx)("div",{className:"modal fade",id:"aaa",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(m.jsx)("div",{className:"modal-dialog",children:Object(m.jsxs)("div",{className:"modal-content",children:[Object(m.jsxs)("div",{className:"modal-header",children:[Object(m.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Leave request details"}),Object(m.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(m.jsxs)("div",{className:"modal-body",children:[Object(m.jsxs)("h5",{children:["Name:",Object(m.jsx)("span",{children:null===c||void 0===c?void 0:c.name})]}),Object(m.jsxs)("h5",{children:["Subject:",Object(m.jsx)("span",{children:null===c||void 0===c?void 0:c.subject})]}),Object(m.jsxs)("h5",{children:["Description:",Object(m.jsx)("span",{children:null===c||void 0===c?void 0:c.body})]}),Object(m.jsxs)("h5",{children:["Type:",Object(m.jsx)("span",{children:null===c||void 0===c?void 0:c.type})]}),Object(m.jsxs)("h5",{children:["From:",Object(m.jsx)("span",{children:new Date(null===c||void 0===c?void 0:c.dateStart).toDateString()})]}),Object(m.jsxs)("h5",{children:["To:",Object(m.jsx)("span",{children:new Date(null===c||void 0===c?void 0:c.dateEnd).toDateString()})]}),Object(m.jsxs)("h5",{children:["No. of days:",Object(m.jsx)("span",{children:null===c||void 0===c?void 0:c.noOfDays})]})]}),Object(m.jsxs)("div",{className:"modal-footer",children:[Object(m.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:function(){O(c._id,1,"Admin",c.noOfDays),b(!j)},children:"Accept"}),Object(m.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-dismiss":"modal",onClick:function(){O(c._id,2,"Admin",c.noOfDays),b(!j)},children:"Decline"})]})]})})})]})]},e._id)}))})]})]})})},U=a(73);var G=function(){var e=JSON.parse(localStorage.getItem("storedUser")),t=Object(D.f)(),a=null===e||void 0===e?void 0:e.user,n=Object(s.useState)(!1),c=Object(o.a)(n,2),r=c[0],l=c[1],j=Object(s.useState)(0),b=Object(o.a)(j,2),h=b[0],v=b[1],f=Object(s.useState)(null),y=Object(o.a)(f,2),S=y[0],w=y[1],E=Object(s.useState)(null),I=Object(o.a)(E,2),A=I[0],L=I[1],P=Object(s.useState)(!0),k=Object(o.a)(P,2),q=k[0],F=k[1],T=Object(s.useState)(!1),H=Object(o.a)(T,2),R=H[0],M=H[1],_=Object(s.useState)([]),J=Object(o.a)(_,2),G=J[0],B=J[1],V=Object(s.useState)({}),Y=Object(o.a)(V,2),$=Y[0],W=Y[1],z=[],K=Object(s.useState)({userId:null===a||void 0===a?void 0:a._id,department:null===a||void 0===a?void 0:a.department,name:null===a||void 0===a?void 0:a.staffName}),Q=Object(o.a)(K,2),X=Q[0],Z=Q[1];Object(s.useEffect)((function(){for(var e=new Date(X.dateStart),t=new Date(X.dateEnd),s=0;e<=t;)s++,e=new Date(+e+864e5);var n=s;v(n),Z(Object(O.a)(Object(O.a)({},X),{},{noOfDays:n})),F(null===A),"Regular"===a.type?"Casual"===X.type&&h>a.regularStaffLeaves||"Earned"===X.type&&h>a.earnedLeaves?M(!0):M(!1):"Probation"===a.type&&("Casual"===X.type&&h>a.probationStaffLeaves?M(!0):M(!1))}),[S,A,h,X.type]),Object(s.useEffect)((function(){a||t("/login")}),[]),Object(s.useEffect)((function(){a&&ae()}),[r]);var ee=Object(s.useContext)(u),te=ee.userArr,ae=ee.getusers,se=ee.postLeaveDetails,ne=function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),W(ce(X)),X.subject&&X.body&&X.type&&X.dateStart&&X.dateEnd){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,se(X);case 6:(a=e.sent)?C.b.success(a.msg):C.b.error("Internal server error"),l(!r),ie(t);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(e){var t={};return e.subject||(t.subject="Subject is required"),e.type||(t.type="Type is required"),e.body||(t.body="Description is required"),e.dateStart||(t.dateStart="Start date is required"),e.subStaff||(t.subStaff="Substitue staff is required"),e.dateEnd||(t.dateEnd="End date is required"),t},re=function(e){Z(Object(O.a)(Object(O.a)({},X),{},Object(x.a)({},e.target.name,e.target.value))),"dateEnd"===e.target.name&&w(e.target.value),"dateStart"===e.target.name&&L(e.target.value)},le=te.filter((function(e){return"Staff"===(null===e||void 0===e?void 0:e.role)&&(null===e||void 0===e?void 0:e.staffName)!==(null===a||void 0===a?void 0:a.staffName)})),ie=function(e){Array.from(e.target).forEach((function(e){return e.value=""})),Z({userId:null===a||void 0===a?void 0:a._id,department:null===a||void 0===a?void 0:a.department,name:null===a||void 0===a?void 0:a.staffName}),B([]),v(0)},de=[];return le.map((function(e){return de.push({value:e.staffName,label:e.staffName})})),Object(s.useEffect)((function(){G.map((function(e){return z.push({name:e.value,status:0})})),Z(Object(O.a)(Object(O.a)({},X),{},{subStaffArr:z}))}),[G]),Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"container leaveForm",children:[Object(m.jsx)("h1",{children:"Apply for a new leave"}),Object(m.jsx)("hr",{}),Object(m.jsxs)(p.a,{onSubmit:ne,children:[Object(m.jsxs)(p.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(m.jsx)(p.a.Label,{className:"fs-3",children:"Subject"}),Object(m.jsx)(p.a.Control,{name:"subject",onChange:re,type:"text"}),Object(m.jsx)("p",{className:"text-danger",children:$.subject})]}),Object(m.jsxs)(p.a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[Object(m.jsxs)(p.a.Label,{className:"fs-3",children:["Description"," ",Object(m.jsx)("span",{className:"fs-6",children:"(Enter all the details of the leave including the reason and timings for substitute teachers)"})]}),Object(m.jsx)(p.a.Control,{onChange:re,as:"textarea",rows:3,name:"body"}),Object(m.jsx)("p",{className:"text-danger",children:$.body})]}),Object(m.jsx)(p.a.Label,{className:"fs-3",children:"Type of leave"}),Object(m.jsxs)(g.a,{controlId:"floatingSelect",label:"Select type of leave",children:[Object(m.jsxs)(p.a.Select,{"aria-label":"Floating label select example",onChange:re,name:"type",children:[Object(m.jsx)("option",{}),"required",Object(m.jsx)("option",{value:"Duty",children:"Duty"}),Object(m.jsx)("option",{value:"Casual",children:"Casual"}),"Regular"===a.type?Object(m.jsx)("option",{value:"Earned",children:"Earned"}):""]}),Object(m.jsx)("p",{className:"text-danger",children:$.type})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{className:"me-2 fs-4",children:"Start date:"}),Object(m.jsx)("input",{name:"dateStart",onChange:re,className:"mb-1",type:"date"}),Object(m.jsx)("span",{className:"text-danger",children:$.dateStart}),Object(m.jsx)("label",{className:" ms-2 fs-4",children:"End date:"}),Object(m.jsx)("input",{name:"dateEnd",onChange:re,className:"mb-1",type:"date",min:X.dateStart,disabled:q}),Object(m.jsx)("span",{className:"text-danger",children:$.dateEnd}),Object(m.jsxs)("label",{className:" ms-2 fs-4",children:["Number of days: ",h]}),Object(m.jsx)("span",{className:"ms-2 fs-5",id:"noOfDays",name:"noOfDays"})]}),Object(m.jsx)("label",{className:" my-2 fs-4",children:"Select substitute staff: "}),Object(m.jsx)(U.a,{options:de,value:G,hasSelectAll:!1,onChange:B}),Object(m.jsx)(N.a,{variant:"primary",disabled:R,className:"mt-4",type:"submit",children:"Submit"})]})]})})},B=a(123);var V=function(){var e=JSON.parse(localStorage.getItem("storedUser")),t=null===e||void 0===e?void 0:e.user,a=Object(D.f)();return Object(s.useEffect)((function(){t||a("/login")}),[]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"5rem"},children:Object(m.jsxs)(B.a,{style:{width:"25rem"},children:[Object(m.jsx)(B.a.Img,{variant:"top",src:"https://nd.net/wp-content/uploads/2016/04/profile-dummy.png",style:{width:"25rem",height:"25rem"}}),Object(m.jsxs)(B.a.Body,{children:[Object(m.jsxs)(B.a.Title,{children:["Name: ",null===t||void 0===t?void 0:t.staffName]}),Object(m.jsxs)(B.a.Title,{children:["Staff ID: ",null===t||void 0===t?void 0:t.staffId]}),Object(m.jsxs)(B.a.Title,{children:["Phone Number: ",null===t||void 0===t?void 0:t.phnumber]}),Object(m.jsxs)(B.a.Title,{children:["Email: ",null===t||void 0===t?void 0:t.email]}),Object(m.jsxs)(B.a.Title,{children:["Role: ",null===t||void 0===t?void 0:t.role]}),Object(m.jsxs)(B.a.Title,{children:["Joining date: ",new Date(null===t||void 0===t?void 0:t.joiningDate).toDateString()]}),"Regular"!==(null===t||void 0===t?void 0:t.type)?Object(m.jsxs)(B.a.Title,{children:["Probation leaves remaining: ",null===t||void 0===t?void 0:t.probationStaffLeaves]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(B.a.Title,{children:["Regular leaves remaining: ",null===t||void 0===t?void 0:t.regularStaffLeaves]}),Object(m.jsxs)(B.a.Title,{children:["Earned leaves remaining: ",null===t||void 0===t?void 0:t.earnedLeaves]})]})]})]})})})},Y=a(120),$=a(121);var W=function(){var e=Object(D.f)(),t=JSON.parse(localStorage.getItem("storedUser"));Object(s.useEffect)((function(){t||e("/login")}),[]);var a=null===t||void 0===t?void 0:t.user,n=Object(s.useState)({}),c=Object(o.a)(n,2),r=c[0],l=c[1],j=Object(s.useRef)(),u=Object(s.useRef)(),h=Object(s.useState)({}),p=Object(o.a)(h,2),v=p[0],f=p[1],g=function(e){var t={};return e.oldPassword||(t.oldPassword="Old password is required"),e.password||(t.password="Password is required"),t},y=function(e){l(Object(O.a)(Object(O.a)({},r),{},Object(x.a)({},e.target.name,e.target.value)))},S=function(){var e=Object(d.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(g(r)),u.current.value===j.current.value){e.next=5;break}C.b.warning("New passwords do not match"),e.next=15;break;case 5:return e.prev=5,e.next=8,b.a.put("http://localhost:4000/api/staff/".concat(a._id),r,{headers:{"content-Type":"application/json"}});case 8:e.sent.data.success?C.b.success("Password updated"):r.oldPassword&&r.password&&C.b.error("Incorrect old password"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(m.Fragment,{children:a?Object(m.jsxs)(Y.a,{bg:"light",expand:"lg",children:[Object(m.jsx)(Y.a.Brand,{className:"mx-4",to:"#home",children:"Leave management"}),Object(m.jsx)(Y.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(m.jsx)(Y.a.Collapse,{id:"basic-navbar-nav",children:Object(m.jsxs)($.a,{className:"me-auto",children:[Object(m.jsxs)("strong",{className:"navbar-text",children:["Hello, ",null===a||void 0===a?void 0:a.staffName]}),Object(m.jsx)($.a.Link,{as:_.b,to:"Admin"===(null===a||void 0===a?void 0:a.role)?"/admin":"Principal"!==a.role?"/":"/principal",children:"Home"}),"Admin"!==a.role&&Object(m.jsx)($.a.Link,{as:_.b,to:"/profile",children:"My profile"}),"Principal"!==a.role&&Object(m.jsx)($.a.Link,{as:_.b,to:"Admin"===(null===a||void 0===a?void 0:a.role)?"/leaveRequests":"/createLeave",children:"Admin"===(null===a||void 0===a?void 0:a.role)?"Incoming Leave Requests":"Create a new leave"})]})}),Object(m.jsx)(N.a,{className:"d-flex mx-4",variant:"primary",onClick:function(){localStorage.removeItem("storedUser"),e("/login")},children:"Logout"}),Object(m.jsx)("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#exampleModal",children:"Change Password"}),Object(m.jsx)("div",{className:"modal fade",id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(m.jsx)("div",{className:"modal-dialog",children:Object(m.jsxs)("div",{className:"modal-content",children:[Object(m.jsxs)("div",{className:"modal-header",children:[Object(m.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Change Password"}),Object(m.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(m.jsxs)("div",{className:"modal-body",children:[Object(m.jsx)("label",{children:"Old Password:"}),Object(m.jsx)("input",{name:"oldPassword",className:"pwdBox",onChange:y,type:"text"}),Object(m.jsx)("p",{className:"text-danger",children:v.oldPassword}),Object(m.jsx)("label",{children:"New Password:"}),Object(m.jsx)("input",{name:"password",onChange:y,type:"password",className:"pwdBox",ref:j}),Object(m.jsx)("p",{className:"text-danger",children:v.password}),Object(m.jsx)("label",{children:"New Password again:"}),Object(m.jsx)("input",{ref:u,type:"password",className:"pwdBox"})]}),Object(m.jsxs)("div",{className:"modal-footer",children:[Object(m.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"}),Object(m.jsx)("button",{type:"button",className:"btn btn-primary",onClick:S,children:"Save changes"})]})]})})})]}):Object(m.jsx)(Y.a,{bg:"light",expand:"lg",children:Object(m.jsx)(Y.a.Brand,{className:"mx-4",to:"#home",children:"Leave management"})})})};var z=function(){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(C.a,{position:"bottom-right",autoClose:2e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(W,{}),Object(m.jsxs)(D.c,{children:[Object(m.jsx)(D.a,{path:"/login",element:Object(m.jsx)(I,{})}),Object(m.jsx)(D.a,{path:"/",element:Object(m.jsx)(M,{})}),Object(m.jsx)(D.a,{path:"/admin",element:Object(m.jsx)(E,{})}),Object(m.jsx)(D.a,{path:"/principal",element:Object(m.jsx)(A,{})}),Object(m.jsx)(D.a,{path:"/leaveRequests",element:Object(m.jsx)(J,{})}),Object(m.jsx)(D.a,{path:"/createLeave",element:Object(m.jsx)(G,{})}),Object(m.jsx)(D.a,{path:"/profile",element:Object(m.jsx)(V,{})})]})]})]})};r.a.render(Object(m.jsx)(n.a.StrictMode,{children:Object(m.jsx)(h,{children:Object(m.jsx)(z,{})})}),document.getElementById("root"))},35:function(e,t,a){}},[[109,1,2]]]);
//# sourceMappingURL=main.1245938d.chunk.js.map